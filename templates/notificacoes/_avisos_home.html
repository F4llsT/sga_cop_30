{% load i18n %}

<section class="alert-section">
    <div class="mb-3">
        <h2>{% trans 'Avisos Importantes' %}</h2>
    </div>
    
    <div class="alert-cards-container">
        {% for aviso in avisos_ativos %}
        <div class="alert-card {{ aviso.classe_css }}-alert" {% if aviso.data_expiracao %}data-expires-at="{{ aviso.data_expiracao|date:'c' }}"{% endif %}>
            <i class="fa-solid fa-{{ aviso.icone }}"></i>
            <div class="alert-content">
                <h4>{{ aviso.titulo }}</h4>
                <p>{{ aviso.mensagem }}</p>
                {% if aviso.data_expiracao %}
                <small class="text-muted">
                    {% trans 'Válido até' %} {{ aviso.data_expiracao|date:'d/m/Y H:i' }}
                </small>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            {% trans 'Nenhum aviso no momento.' %}
        </div>
        {% endfor %}
    </div>
</section>

<style>
.alert-card {
    display: flex;
    align-items: flex-start;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    color: white;
    position: relative;
}

.alert-card i {
    font-size: 1.5rem;
    margin-right: 1rem;
    margin-top: 0.25rem;
}

.alert-content {
    flex: 1;
}

.alert-content h4 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
}

.alert-content p {
    margin: 0;
    font-size: 0.95rem;
}

.alert-actions {
    margin-left: 1rem;
    opacity: 0;
    transition: opacity 0.2s ease;
}

.alert-card:hover .alert-actions {
    opacity: 1;
}

/* Cores para os diferentes níveis de alerta */
.info-alert {
    background-color: #0d6efd;
}

.warning-alert {
    background-color: #ffc107;
    color: #000;
}

.warning-alert .text-muted {
    color: rgba(0, 0, 0, 0.6) !important;
}

.danger-alert {
    background-color: #dc3545;
}

/* Animações */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.alert-card {
    animation: fadeIn 0.3s ease-out forwards;
}

.alert-card.expired {
    opacity: 0.6;
    background-color: #6c757d;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Verificar avisos expirados
    const alertCards = document.querySelectorAll('.alert-card[data-expires-at]');
    const now = new Date();
    
    alertCards.forEach(card => {
        const expiresAt = new Date(card.dataset.expiresAt);
        if (expiresAt < now) {
            card.classList.add('expired');
        }
    });
});
</script>
