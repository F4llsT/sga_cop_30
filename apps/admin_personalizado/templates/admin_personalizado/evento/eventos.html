{% extends "admin_personalizado/baseadmin.html" %}
{% load static %}

{% block title %}Gerenciamento de Eventos{% endblock %}

{% block content %}


<div class="eventos-admin">
    <div class="admin-wrapper">
        <main class="main-content">
            <div class="section">
                <div class="main-header">
                    <h2>Gerenciamento de Eventos</h2>
                    <div class="user-area">
                        <span>Bem-vindo, {{ request.user.get_full_name|default:request.user.username }}</span>
                    </div>
                </div>

                <div class="form-container">
                    <form id="form-evento">
                        {% csrf_token %}
                        <input type="hidden" id="evento-id" value="">
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="evento-titulo" class="form-label">Título do Evento</label>
                                <input type="text" id="evento-titulo" class="form-control" required>
                            </div>
                            
                        </div>
                        <div class="form-group">
                            <label for="evento-descricao" class="form-label">Descrição</label>
                            <textarea id="evento-descricao" class="form-control" rows="3"></textarea>
                        </div>


                        <div class="form-row">

                            <div class="form-group">
                                <label for="evento-data" class="form-label">Data de Início</label>
                                <input type="date" id="evento-data" class="form-control" required>
                            </div>

                            <div class="form-group">
                                <label for="evento-inicio" class="form-label">Hora de Início</label>
                                <input type="time" id="evento-inicio" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="evento-data" class="form-label">Data de Término</label>
                                <input type="date" id="evento-data" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="evento-fim" class="form-label">Hora de Término</label>
                                <input type="time" id="evento-fim" class="form-control" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="evento-local" class="form-label">Local</label>
                                <input type="text" id="evento-local" class="form-control" required>
                            </div>

                            <div class="form-group col-md-6">
                                <label for="evento-palestrantes" class="form-label">Palestrantes</label>
                                <select id="evento-palestrantes" class="form-select" multiple>
                                    <!-- Opções serão carregadas via JavaScript -->
                                </select>
                                <small class="form-text text-muted">Segure Ctrl para selecionar múltiplos palestrantes</small>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="evento-tags" class="form-label">Tags</label>
                                <input type="text" id="evento-tags" class="form-control" placeholder="Ex: palestra,workshop,tecnologia">
                                <small class="form-text text-muted">Separe as tags por vírgula</small>
                            </div>
                            
                            <div class="form-group col-md-6">
                                <div class="form-check form-switch mt-4 pt-2">
                                    <input class="form-check-input" type="checkbox" id="evento-importante">
                                    <label class="form-check-label" for="evento-importante">Evento Importante</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="evento-latitude" class="form-label">Latitude</label>
                                <div class="input-group">
                                    <input type="number" step="any" id="evento-latitude" class="form-control" placeholder="Ex: -23.550520">
                                    <button type="button" id="btn-localizar" class="btn btn-outline-secondary">
                                        <i class="fas fa-map-marker-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="form-group col-md-6">
                                <label for="evento-longitude" class="form-label">Longitude</label>
                                <input type="number" step="any" id="evento-longitude" class="form-control" placeholder="Ex: -46.633308">
                            </div>
                        </div>

                        <div class="form-group mb-4">
                            <div id="map" style="height: 250px; width: 100%; border-radius: 8px; border: 1px solid #dee2e6;"></div>
                            <small class="form-text text-muted">Clique no mapa para definir a localização ou use o botão de localização</small>
                        </div>

                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" id="btn-limpar" class="btn btn-outline-secondary">
                                <i class="fas fa-eraser"></i> Limpar
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Salvar Evento
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="section-title">Eventos Agendados</h3>
                    <button id="btn-atualizar" class="btn btn-outline-secondary">
                        <i class="fas fa-sync-alt"></i> Atualizar
                    </button>
                </div>

                <div class="search-container">
                    <div class="search-bar">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="search-input" class="search-input" placeholder="Pesquisar eventos...">
                    </div>
                </div>

                <div id="lista-eventos" class="events-container">
                    <!-- Os eventos serão carregados aqui via JavaScript -->
                    <div class="text-center py-5 text-muted">
                        <i class="fas fa-calendar-alt fa-3x mb-3"></i>
                        <p>Nenhum evento agendado</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Confirmação -->
    <div id="confirm-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirmar Exclusão</h3>
                <button type="button" class="action-btn close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir este evento? Esta ação não pode ser desfeita.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">
                    Cancelar
                </button>
                <button type="button" class="btn btn-danger" id="btn-confirmar-exclusao">
                    <i class="fas fa-trash"></i> Excluir
                </button>
            </div>
        </div>
    </div>
</div>

{% block extra_css %}
{{ block.super }}
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/m5Z5SaKGOGn+urRk="
    crossorigin=""/>
<!-- Select2 CSS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<!-- Custom CSS -->
<link rel="stylesheet" href="{% static 'admin_personalizado/css/eventos.css' %}">
{% endblock %}

{% block extra_js %}
{{ block.super }}
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
<!-- Custom JS -->
<script src="{% static 'admin_personalizado/js/eventos.js' %}"></script>
<!-- Inicialização do Select2 -->
<script>
    $(document).ready(function() {
        $('.select2').select2({
            theme: 'bootstrap4',
            placeholder: 'Selecione...',
            allowClear: true
        });
    });
</script>
{% endblock %}
{% endblock %}