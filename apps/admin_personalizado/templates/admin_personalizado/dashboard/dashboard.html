{% extends 'admin_personalizado/baseadmin.html' %}

{% block title %}Dashboard - COP30{% endblock %}

{% block content %}
    <header class="main-header">
        <h2>Dashboard de Métricas</h2>
        <div class="user-area">
            <span>Admin</span>
            <i class="fa-solid fa-user-shield"></i>
        </div>
    </header>

    <section class="summary-section">
        <div class="summary-card">
            <div class="card-icon users"><i class="fa-solid fa-users"></i></div>
            <div class="card-content"><p>Total de Usuários</p><span class="stat-number">{{ summary.total_users }}</span></div>
        </div>
        <div class="summary-card">
            <div class="card-icon active-users"><i class="fa-solid fa-street-view"></i></div>
            <div class="card-content"><p>Usuários Ativos Hoje</p><span class="stat-number">{{ summary.active_today }}</span></div>
        </div>
        <div class="summary-card">
            <div class="card-icon passe-facil"><i class="fa-solid fa-ticket-simple"></i></div>
            <div class="card-content"><p>Usos do Passe Fácil</p><span class="stat-number">{{ summary.passe_uses }}</span></div>
        </div>
        <div class="summary-card">
            <div class="card-icon events"><i class="fa-solid fa-star"></i></div>
            <div class="card-content"><p>Evento Mais Favoritado</p><span class="stat-text ellipsis" title="{{ summary.top_event }}">{{ summary.top_event }}</span></div>
        </div>
    </section>

    <section class="charts-section">
        <div class="chart-container" style="width:100%">
            <div class="charts-toolbar" style="display:flex; gap:.5rem; align-items:center; justify-content:flex-end; margin-bottom:.5rem">
                <span style="opacity:.8; font-size:.9rem">Período:</span>
                <a href="?period=today" class="btn btn-small{% if period == 'today' %} active{% endif %}"{% if period == 'today' %} aria-current="page"{% endif %}>Hoje</a>
                <a href="?period=7d" class="btn btn-small{% if period == '7d' %} active{% endif %}"{% if period == '7d' %} aria-current="page"{% endif %}>7 dias</a>
                <a href="?period=30d" class="btn btn-small{% if period == '30d' %} active{% endif %}"{% if period == '30d' %} aria-current="page"{% endif %}>30 dias</a>
            </div>
            <h3>Eventos Mais Favoritados</h3>
            <div class="chart-wrapper">
                <canvas id="eventosChart"></canvas>
            </div>
        </div>
    </section>
    
    <section class="shortcuts-section">
        <h2>Ações Rápidas</h2>
        <div class="shortcuts-grid">
            <a href="#" class="shortcut-card users-shortcut">
                <i class="fa-solid fa-users-gear"></i>
                <h3>Gerenciar Usuários</h3>
                <p>Adicionar, remover e editar permissões de usuários.</p>
            </a>
            <a href="#" class="shortcut-card agenda-shortcut">
                <i class="fa-solid fa-calendar-plus"></i>
                <h3>Gestão de Agenda</h3>
                <p>Criar, editar e publicar eventos na agenda oficial.</p>
            </a>
            <a href="#" class="shortcut-card notifications-shortcut">
                <i class="fa-solid fa-paper-plane"></i>
                <h3>Enviar Notificações</h3>
                <p>Mandar alertas e comunicados para todos os usuários.</p>
            </a>
            <a href="#" class="shortcut-card passe-facil-shortcut">
                <i class="fa-solid fa-ticket-simple"></i>
                <h3>Validar Passe Fácil</h3>
                <p>Acessar o leitor de QR Code para validar ingressos e passes.</p>
            </a>
        </div>
    </section>

    {# Dados para gráficos de forma segura #}
    {{ eventos_labels|json_script:"eventos-labels" }}
    {{ eventos_values|json_script:"eventos-values" }}

    <!-- Gráficos são renderizados por static/admin_personalizado/js/base&dahs.js -->
{% endblock %}
